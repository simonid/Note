# shell脚本初学
shell有几种，下面列出容易混乱的两种：
```
sh(全称 Bourne Shell): 是UNIX最初使用的 shell，而且在每种 UNIX 上都可以使用。
Bourne Shell 在 shell 编程方面相当优秀，但在处理与用户的交互方面做得不如其他几种 shell。

bash（全称 Bourne Again Shell）: LinuxOS 默认的，它是 Bourne Shell 的扩展。
与 Bourne Shell 完全兼容，并且在 Bourne Shell 的基础上增加了很多特性。可以提供命令补全，命令编辑和命令历史等功能。它还包含了很多 C Shell 和 Korn Shell 中的优点，有灵活和强大的编辑接口，同时又很友好的用户界面。 
```
<b>为了方便，后面提到的shell脚本都是指bash脚本()也简写为sh脚本</b><br>
一个shell脚本的开头都带有`#!/bin/sh`或`!#/bin/bash`的字样，其中`#!`是说明该脚本文件通过解释器执行，`#!`后的路径就是该解释器路径。<br>
实际上，在执行`sh`和`bash`命令的时候，它们的结果是不完全相同的，`sh`是`bash`的一个软链接。
 `/bin/sh` 相当于 `/bin/bash --posix`。<br>
 那么，对于一个sh脚本来说，`./`的执行方式和`sh`跟`bash`有说明区别呢？前面的方法是打开一个子shell并读取文件中的命令，运行一个sh脚本会启动另外一个解释器，每个sh脚本能够运行在父shell的一个子进程中，这里的父shell是指一个控制终端输出提示符的进程。后面的那两种是在当前bash环境读取文件中的命令，该文件可以无执行权限（能执行部分命令，在最后会抛出错误信息）。<br>

 ## 变量
 定义变量和赋值时，变量名不加`$`，使用定义过的变量的时候需要加上
 ```
 name="tony"
 echo $name
 ```
 注意，变量名和等号之间不能有空格，其他规定：
 ```
    首个字符必须为字母（a-z，A-Z）。
    中间不能有空格，可以使用下划线（_）。
    不能使用标点符号。
    不能使用bash里的关键字（可用help命令查看保留关键字）。
 ```
针对用` `` `包含的命令，其执行结果可以赋给一个变量，比如
```
for file in `ls /var`
```
还有一点要注意变量的标界，加花括号可以让解释器正确解析，比如`${Java}Script`中变量是`Java`，而`$JavaScript`，变量是`JavaScript`<br>

#### 只读变量
通过`readonly`命令可以将变量定义为只读
#### 删除变量
使用`unset`命令可以删除变量（和前面只读一样变量不用加$）
### 变量类型
<b>1) 局部变量</b> 局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。<br>
<b>2) 环境变量</b> 所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。<br>
<b>3) shell变量</b> shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行<br>

## 字符串
#### 单引号
单引号内任何字符原样输出，所以单引号字符串内的变量是无效的；单引号字符串内不能有单引号，需要转义字符<br>
#### 双引号
和单引号特点相反
#### 拼接
`var3=${var1}${var2}`
#### 获取长度
`echo ${#string}`
#### 提取子串
`echo ${string 1:3}`:输出字符串第2到第3个字符
#### 查找子串
```
string="hello"
$ echo `expr index "$string" ll`
3
```
### 字符串常用的截取方法
假设有变量 var=http://www.aaa.com/123.htm
#### #号截取，删除左边，保留右边
```
echo ${var#*//}
```
 其中 var 是变量名，# 号是运算符，*// 表示从左边开始删除第一个 // 号及左边的所有字符
<br>
即删除 http://,结果是 ：www.aaa.com/123.htm<br>
#### ## 号截取，删除左边字符，保留右边字符
```
echo ${var##*/}
```
`##*/`表示从左边开始删除最后（最右边）一个 / 号及左边的所有字符
<br>
即删除 http://www.aaa.com/
<br>
结果是 123.htm<br>
####  %号截取，删除右边字符，保留左边字符
```
echo ${var%/*}
```
 `%/*`表示从右边开始，删除第一个 / 号及右边的字符
<br>
结果是：http://www.aaa.com<br>
#### %% 号截取，删除右边字符，保留左边字符
```
echo ${var%%/*}
```
`%%/*` 表示从右边开始，删除最后（最左边）一个 / 号及右边的字符
<br>
结果是：http:<br>
#### 从左边第几个字符开始，及字符的个数
```
echo ${var:7}  //结果是 ：www.aaa.com/123.htm
```
#### 从右边第几个字符开始，及字符的个数
```
echo ${var:0-7:3}  //结果是：123
```
#### 从右边第几个字符开始，一直到结束
```
echo ${var:0-7}  //结果是：123.htm
```
注：（左边的第一个字符是用 0 表示，右边的第一个字符用 0-1 表示）<br>
总结：
```
#、## 表示从左边开始删除。一个 # 表示从左边删除到第一个指定的字符；两个 # 表示从左边删除到最后一个指定的字符。

%、%% 表示从右边开始删除。一个 % 表示从右边删除到第一个指定的字符；两个 % 表示从左边删除到最后一个指定的字符。
删除包括了指定的字符本身
```
参考：<br>
[linux shell 字符串操作（长度，查找，替换）详解](http://www.cnblogs.com/chengmo/archive/2010/10/02/1841355.html)<br>

## 数组
#### 读取数组
`${数组名[下标]}`。
<br>
补充：`echo ${array_name[@]}`输出数组中所有元素<br>
#### 获取长度
和字符串方法一样
```
# 取得数组元素的个数
length=${#array_name[@]}
# 或者
length=${#array_name[*]}
# 取得数组单个元素的长度
lengthn=${#array_name[n]}
```